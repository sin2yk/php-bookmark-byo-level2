# ①課題名
BYOワイン会・持ち寄りボトル登録アプリ  
（PHP版アンケート＆ブックマーク編集削除）

## ②課題内容（どんな作品か）

- 「すでに開催が決まっているワイン会」の **持ち寄りワイン情報だけ** を事前に集めるための軽量Webアプリ。
- 参加者はURLにアクセスして、自分の持ち寄りボトルをフォームから登録する。
- アプリ側では、ワインの **タイプ（泡・白・赤など）／価格帯／テーマ適合度** を構造化して保存。
- 参加者は「1枚の Wine List」として、当日のラインナップの雰囲気をブラインド付きで確認できる。
- 幹事は別画面（幹事ビュー）から、タイプや価格帯のバランス、テーマ適合度の平均などを確認し、事前に微調整ができる。
- **今回（v3）は、登録済みエントリーの「編集・削除」機能を実装し、G’sのブックマークアプリ③（編集削除）に相当するCRUDをBYO文脈で体験できるようにした。**

※ 本アプリは「日程調整／店探し／出欠管理」は扱わず、  
　**開催確定後の BYO 調整だけに特化** している。

---

## ③アプリのデプロイURL

- ローカル開発環境：`http://localhost/BYO/`  
- 本番デプロイ（予定）：未定

---

## ④アプリのログイン用IDまたはPassword（ある場合）

現バージョン（v3）はログイン機能なし。

- 参加者ビュー（`list.php`）
  - URLを知っていれば誰でも閲覧可能
  - 登録完了画面から、自分のエントリーに紐づいた `edit.php?id=◯◯` へのリンクを表示し、
    そのURLを知っている人だけが編集・削除できる想定
- 幹事ビュー（`list_admin.php`）
  - URL直アクセス前提の簡易運用
  - 一覧から全エントリーに対して「編集」「削除」ボタンを持つ

※ 本番運用を想定したログイン認証・権限制御は、今後のPHPログイン課題および Firebase Auth 連携で実装予定。

---

## ⑤工夫した点・こだわった点

- **BYOワイン会という具体的なユースケースに特化**
  - 既存の「なんでもアンケート」ではなく、
    「泡／白／赤／価格帯／テーマ適合度」を事前に可視化することに全振り。
  - 日程・出欠・店探しなどは他ツールに任せることで、アプリの性格を明確化。

- **ブックマーク③に対応する編集・削除フロー**
  - 幹事用 `list_admin.php` からは、各行の右側に「編集」「削除」ボタンを配置し、
    一般的なブックマークアプリのCRUDパターンを再現。
  - 参加者向けには、登録完了画面から `edit.php?id=◯◯` へのリンクを案内し、
    「自分のエントリーだけを後から修正・取消できる」フローを用意。
  - `edit.php` は GET（フォーム表示）と POST（更新・削除）を1ファイルで処理し、
    コード量を抑えつつロジックを整理した。

- **項目ごとのブラインド設定**
  - 生産者／ワイン名／ヴィンテージ／産地／価格帯／コメントごとに
    「表示させたくない（ブラインド希望）」チェックを用意。
  - 参加者ビューでは `??? / XXXX / （非公開）` にマスクして表示。
  - 幹事ビューでも「登録者名・タイプ・テーマ適合度」以外はブラインド指定どおり伏せる仕様にして、
    ブラインド会でも幹事だけが一人勝ちしないよう配慮。

- **1枚の Wine List（メーカーズディナー風レイアウト）**
  - 無機質な `<table>` だけでなく、A4紙1枚に印刷することを想定した
    「番号付きテキスト行のワインリスト」レイアウトも検討。
  - 例：  
    `1. Producer – Cuvée – Vintage`  
    `   Region / Type / Price: Prestige / by Shinji さん`
  - そのまま印刷すればメニュー表として使えるデザインに寄せた。

- **価格帯は「レンジ＋ニックネーム」で数字をぼかす**
  - 価格帯は自己申告で  
    `〜5千円 / 5〜10千円 / 10〜20千円 / 20〜50千円 / 50千円以上` を選択。
  - DBには `charming / reasonable / valuable / expensive / prestige` として保存し、
    参加者向けリストでは「Price: Prestige」のようにニックネームだけ表示。
  - 「あまり生々しい金額は出したくないけど、大きなミスマッチは避けたい」
    というワイン会の心理に合わせた。

- **フォームは“BYOあるある”を反映した入力設計**
  - ヴィンテージ：`NV / 1970年以前 / 1971〜2025（若い年が上に並ぶ）`
  - 産地：代表的な地域のプルダウン＋「その他」自由入力。
  - タイプ：`sparkling / white / orange / red_pinot / red_other / rose / sweet / fortified`
    という現場感のあるカテゴリ。
  - テーマ適合度：1〜5の自己評価（幹事のバランス調整用）。

- **将来の編集・ブラインド解除に備えたパスワード設計**
  - 登録時に任意の「編集／ブラインド解除用パスワード」を登録可能（カラム `blind_password_hash`）。
  - 現バージョンではまだパスワード入力画面までは実装していないが、
    v4 以降で「自分のエントリーだけをパスワードで守る」機能に利用予定。
  - PHPログイン課題やFirebase Authと組み合わせて、「誰がどのボトルを編集できるか」を厳密に制御する土台にしたい。

---

## ⑥難しかった点・次に実装したいこと

- **難しかった点**
  - テーブル設計：
    - `bottle_entries` に「実データ」と「ブラインドフラグ」をどう共存させるか整理するのが難しかった。
    - 将来のログイン機能や編集機能を見据えて、`blind_password_hash` など拡張用のカラムも先に用意した。
  - ブラインド表示ロジック：
    - 参加者ビュー・幹事ビューで「どの項目を誰に見せるか」のルール整理に時間がかかった。
    - `list.php` と `list_admin.php` それぞれで、マスク処理と生データ表示の切り替えを実装する必要があった。
  - 編集・削除フロー：
    - `edit.php` で GET と POST を1ファイルにまとめる際、
      「ID未指定のときはガードして終了」「更新後・削除後はどこに戻すか」など
      フロー全体を頭の中でトレースしながら実装する必要があり、最初は混乱した。
    - `list_admin.php` からの削除をPOSTで受けて、その後に再度一覧を表示する…という
      一連の流れを整理することで、PHPでの一般的なCRUDパターンを体感できた。

- **次に実装したいこと（v4以降）**
  - 参加者による自分のエントリーの編集・削除を、編集パスワード or ログインと結びつけて厳密に制御する。
  - 幹事専用ログイン：
    - 簡易パスワード or セッションを使って `list_admin.php` を保護し、
      誰でもURL直打ちで編集できないようにする。
  - イベントの複数管理：
    - 現状は `event_id = 1` 固定だが、`events` テーブルを作り、
      幹事が複数のワイン会を作成・管理できるようにする。
  - Firebase Auth との連携：
    - パスワード管理はFirebaseに任せ、アプリ側は `uid` を受け取って
      `users` / `events` / `bottle_entries` をひも付ける構成にしていきたい。
  - スマホビューの微調整：
    - すでに `meta viewport` 対応済だが、
      スマホでのフォントサイズ・余白などをさらに整えて読みやすくする。
